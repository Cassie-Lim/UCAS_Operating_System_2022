# OS作业12
<center>
    林孟颖 2020K8009915008
</center>
[TOC]

### 12.1 

现有一块320GB的SLC SSD，它的擦写上限(P/E cycles)是 100,000 次。假设SSD FTL能将**写均匀分布在所有的闪存页上**，若以每秒发 300,000 个写请求的速率写，请问多长时间这块SSD 会被磨穿?

---

 假设块大小4KB，则320GB共计80M块，以块为单位的总擦写次数上限为$80M \times 10^{5}$次。

写操作以页为单位，而每次写都需要先做擦除，而擦除以块为单位，故每次写都需要擦除整块、重写整块，故一次写操作实际上包含2次以块为单位的擦写操作，则最长工作时间：
$$
\frac{80M \times 10^{5}}{2\times 3\times 10^{5}}s \approx 13.3\times 2^{20} s
$$

### 12.2 
现有一块SSD，每个擦除块有64页，且它读一页的延迟是20微秒，写一页的延迟是 100微秒，擦除一块的时间是2毫秒。如果该SSD的FTL采用混合映射，分下面3种情况，计算回收一个块需要的时间。

1) Switch merge

2) Partial merge 且假设块中有效页为 40% 

3) Full merge

---

1) Switch merge

直接将日志块转换成数据块，无需进行数据的拷贝，只需做原本的块的擦除，耗时2ms；

2) Partial merge 且假设块中有效页为 40% 

- 将数据块中有效页拷贝到日志块，耗时64 x 40% x ( 20us + 100us) = 3072us;
- 将原本的数据块擦除，耗时2ms

耗时共计5.072ms。

3) Full merge

- 重新分配一个块，分别从数据块和日志块中拷贝有效快，耗时64 x ( 20us + 100us) = 7680us;
- 将原本的数据块擦除，耗时2ms

耗时共计9.68ms。
